reference-state:
  Tref: 0.
  Pref: 1.e5

species:
  - name: dry
    composition: { H: 2 }
    cv_R: 2.5

  - name: H2O
    composition: { H: 2, O: 1 }
    cv_R: 2.5
    u0_R: 0.

  - name: H2O(l)
    composition: { H: 2, O: 1 }
    cv_R: 9.0
    u0_R: -3430.

  - name: H2O(l,p)
    composition: { H: 2, O: 1 }
    cv_R: 9.0
    u0_R: -3430.

geometry:
  type: gnomonic-equiangle
  bounds:
    x1min: 1.2742e7
    x1max: 1.3642e7
    x2min_pi: -0.25
    x2max_pi: 0.25
    x3min_pi: -0.25
    x3max_pi: 0.25
  cells:
    nx1: 100
    nx2: 96
    nx3: 96
    nghost: 3

distribute:
  backend: nccl
  layout: cubed-sphere
  nb2: 1
  nb3: 1
  verbose: false

dynamics:
  equation-of-state:
    type: ideal-moist
    density-floor: 1.e-10
    pressure-floor: 1.e-10
    tracer-floor: 1.e-12
    limiter: true
    max-iter: 30
    ftol: 1.e-6
  vertical-projection:
    type: temperature
    pressure-margin: 1.e-6
  reconstruct:
    vertical: { type: weno5, scale: true, shock: true }
    horizontal: { type: weno5, scale: true, shock: true }
  riemann-solver:
    type: hllc

boundary-condition:
  internal:
    solid-density: 1.e3
    solid-pressure: 1.e9
    max-iter: 5
  external:
    x1-inner: reflecting
    x1-outer: reflecting
    x2-inner: custom
    x2-outer: custom
    x3-inner: custom
    x3-outer: custom

integration:
  type: rk3
  cfl: 0.45
  implicit-scheme: 9
  nlim: -1
  tlim: 4.32e7 # 500 days
  ncycle_out: 1

outputs:
  - type: restart
    dt: 8.64e5 # every 10 days
  - type: netcdf
    variables: [prim]
    dt: 8.64e4 # every day
  - type: netcdf
    variables: [thermo, path]
    dt: 8.64e4

forcing:
  const-gravity:
    grav1: -10.0
  coriolis:
    type: xyz
    omega1: 2.4240684e-6

sedimentation:
  radius:
    H2O(l,p): 1.0e-10
  density:
    H2O(l,p): 1000.
  const-vsed:
    H2O(l,p): -2.0

reactions:
  - equation: H2O <=> H2O(l)
    type: nucleation
    rate-constant: { formula: h2o_ideal }
  - equation: H2O(l) => H2O(l,p)
    type: coagulation
    rate-constant: { A: 0.01, b: 0, Ea_R: 0. }
  - equation: H2O(l,p) => H2O
    type: evaporation
    rate-constant:
      {
        formula: h2o_ideal,
        diff_c: 0.2e-4,
        diff_T: 0.,
        diff_P: 0.,
        vm: 18.e-6,
        diameter: 1.0e-4,
      }

problem:
  Ts: 800.
  Tmin: 200.
  Ps: 1.e6
  xH2O: 0.1
  stellar_flux_nadir: 2000.0
  substellar_lon_deg: 0.0
  substellar_lat_deg: 0.0

radiative-transfer:
  update_dt: 3600.0
  shortwave_band: sw
  longwave_band: lw
  sw_surface_albedo: 0.0
  lw_surface_albedo: 0.0

opacities:
  doublegrey-sw:
    type: jit
    model: simple-grey
    data: [rt/doublegrey_sw.pt]
    species: [dry, H2O, H2O(l), H2O(l,p)]
    jit_kwargs: [pres, temp]
    nmom: 1
    parameters: { kappa_a: 1.0e-2, kappa_b: -0.5, kappa_cut: 1.0e-4 }

  doublegrey-lw:
    type: jit
    model: simple-grey
    data: [rt/doublegrey_lw.pt]
    species: [dry, H2O, H2O(l), H2O(l,p)]
    jit_kwargs: [pres, temp]
    nmom: 1
    parameters: { kappa_a: 1.6e-8, kappa_b: 1.0, kappa_cut: 1.0e-4 }

bands:
  - name: sw
    range: [10000.0, 50000.0]
    opacities: [doublegrey-sw]
    solver: toon
    nwave: 1
    nstr: 2

  - name: lw
    range: [10.0, 10000.0]
    opacities: [doublegrey-lw]
    solver: toon
    nwave: 1
    nstr: 2
